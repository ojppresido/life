<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h3>Exam: <%= subject %></h3>
            <div class="alert alert-info">
                Time Remaining: <span id="timer">00:00</span>
            </div>
        </div>
        
        <form id="examForm" action="/submit-exam" method="POST">
            <% questions.forEach((question, index) => { %>
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0">Question <%= index + 1 %> of <%= questions.length %></h5>
                    </div>
                    <div class="card-body">
                        <h6 class="card-title"><%= question.questionText %></h6>
                        <div class="form-check mb-2">
                            <% question.options.forEach(option => { %>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="answers[<%= question.id %>]" id="q<%= question.id %>_<%= option.id %>" value="<%= option.id %>">
                                    <label class="form-check-label" for="q<%= question.id %>_<%= option.id %>">
                                        <%= option.text %>
                                    </label>
                                </div>
                            <% }); %>
                        </div>
                    </div>
                </div>
            <% }); %>
            
            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-success btn-lg">Submit Exam</button>
                <a href="/" class="btn btn-secondary">Cancel Exam</a>
            </div>
        </form>
    </div>
</div>

<script>
    // Timer functionality
    let timeRemaining = <%= timeRemaining %>;
    const timerElement = document.getElementById('timer');
    
    function updateTimer() {
        const minutes = Math.floor(timeRemaining / 60);
        const seconds = timeRemaining % 60;
        
        timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        
        if (timeRemaining <= 0) {
            // Time's up - auto-submit
            document.getElementById('examForm').submit();
        } else {
            timeRemaining--;
            setTimeout(updateTimer, 1000);
        }
    }
    
    // Start the timer
    updateTimer();
    
    // Warn user before leaving the exam
    window.addEventListener('beforeunload', function(e) {
        e.preventDefault();
        e.returnValue = 'Are you sure you want to leave the exam? Your progress will be lost.';
    });
</script>